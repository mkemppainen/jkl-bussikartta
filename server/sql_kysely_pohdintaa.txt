Pientä aihiota sille, miten kannasta saadaan haettua tarvittavaa data.

1.
Tietyn reitin välille kuuluvat pysäkit ja niiden koordinaatit.
Nämä tulisi vielä jotenkin järkevästi yhdistää.

Haetaan argumenttina saadulle reitille kuuluvat trip id:t

select trip_id
from matkat
where route_id in 
   (select route_id
    from matkojen_nimet
    where lnimi is ARGUMENTTI)

Haetaan löydetyille trip_id:lle kuuluvat stop_id:t

select stop_id
from pysahtymis_ajat
where trip_id in (ylempi kysely)

Haetaan löydetyille stop_id:lle koordinaatit

select lat, lon
from pysakit
where stop_id in (ylempi kysely)

2.
Valittuna olevan linjan bussien sijainnit argumenttina saadun ajan peruteella
linja = argumentti
aika = argumentti
pvm = argumentti

select trip_id, stop_id, saapumis_aika_tunnit, saapumis_aika_minuutit, saapumis_aika_sekunnit, lahto_aika_tunnit, lahto_aika_minuutit, lahto_aika_sekunnit, jnum
from pysahtymis_ajat
where saapumis_aika_tunnit = 11 and
saapumis_aika_minuutit between 49 and 59
and
trip_id in
(select trip_id
from matkat
where route_id in
(select route_id
from matkojen_nimet
where lnimi like "27")
and service_id like "M-P Kesä")
order by trip_id;


3.
Tietylle linjalle liittyvien pysähdysten aikataulut
select distinct pysakit.lat, pysakit.lon, pysahtymis_ajat.saapumis_aika_tunnit, pysahtymis_ajat.saapumis_aika_minuutit, pysahtymis_ajat.lahto_aika_tunnit, pysahtymis_ajat.lahto_aika_minuutit, pysahtymis_ajat.jnum
from pysakit, pysahtymis_ajat
where pysakit.stop_id = pysahtymis_ajat.stop_id and
pysahtymis_ajat.trip_id in 
(select trip_id from matkat
where route_id in
(select route_id from matkojen_nimet where lnimi like "27"))
order by pysahtymis_ajat.lahto_aika_tunnit;
